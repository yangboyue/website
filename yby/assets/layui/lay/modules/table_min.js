layui.define(["laytpl","laypage","layer","form","util"],function(L){var y=layui.$,I=layui.laytpl,m=layui.laypage,h=layui.layer,A=layui.form,k=layui.util,r=layui.hint(),M=layui.device(),q={config:{checkName:"LAY_CHECKED",indexName:"LAY_TABLE_INDEX"},cache:{},index:layui.table?(layui.table.index+10000):0,set:function(P){var Q=this;Q.config=y.extend({},Q.config,P);return Q},on:function(P,Q){return layui.onevent.call(this,N,P,Q)}},o=function(){var Q=this,P=Q.config,R=P.id||P.index;if(R){o.that[R]=Q;o.config[R]=P}return{config:P,reload:function(S){Q.reload.call(Q,S)},setColsWidth:function(){Q.setColsWidth.call(Q)},resize:function(){Q.resize.call(Q)},refresh:function(){Q.refresh.call(Q)},reloadExt:function(S){Q.reloadExt.call(Q,S)}}},t=function(Q){var P=o.config[Q];if(!P){r.error("The ID option was not found in the table instance")}return P||null},H=function(P,R,Q,T){var S=P.templet?function(){return typeof P.templet==="function"?P.templet(Q):I(y(P.templet).html()||String(R)).render(Q)}():R;return T?y("<div>"+S+"</div>").text():S},N="table",j=".layui-table",u="layui-this",f="layui-show",i="layui-hide",x="layui-disabled",D="layui-none",B="layui-table-view",b=".layui-table-tool",J=".layui-table-box",v=".layui-table-init",l=".layui-table-header",g=".layui-table-body",E=".layui-table-main",F=".layui-table-fixed",e=".layui-table-fixed-l",O=".layui-table-fixed-r",c=".layui-table-total",C=".layui-table-page",w=".layui-table-sort",a="layui-table-edit",G="layui-table-hover",p=function(P){var Q='{{#if(item2.colspan){}} colspan="{{item2.colspan}}"{{#} if(item2.rowspan){}} rowspan="{{item2.rowspan}}"{{#}}}';P=P||{};return['<table cellspacing="0" cellpadding="0" border="0" class="layui-table" ','{{# if(d.data.skin){ }}lay-skin="{{d.data.skin}}"{{# } }} {{# if(d.data.size){ }}lay-size="{{d.data.size}}"{{# } }} {{# if(d.data.even){ }}lay-even{{# } }}>',"<thead>","{{# layui.each(d.data.cols, function(i1, item1){ }}","<tr>","{{# layui.each(item1, function(i2, item2){ }}",'{{# if(item2.fixed && item2.fixed !== "right"){ left = true; } }}','{{# if(item2.fixed === "right"){ right = true; } }}',function(){if(P.fixed&&P.fixed!=="right"){return'{{# if(item2.fixed && item2.fixed !== "right"){ }}'}if(P.fixed==="right"){return'{{# if(item2.fixed === "right"){ }}'}return""}(),"{{# var isSort = !(item2.colGroup) && item2.sort; }}",'<th data-field="{{ item2.field||i2 }}" data-key="{{d.index}}-{{i1}}-{{i2}}" {{# if( item2.parentKey){ }}data-parentkey="{{ item2.parentKey }}"{{# } }} {{# if(item2.minWidth){ }}data-minwidth="{{item2.minWidth}}"{{# } }} '+Q+' {{# if(item2.unresize || item2.colGroup){ }}data-unresize="true"{{# } }} class="{{# if(item2.hide){ }}layui-hide{{# } }}{{# if(isSort){ }} layui-unselect{{# } }}{{# if(!item2.field){ }} layui-table-col-special{{# } }}">','<div class="layui-table-cell laytable-cell-',"{{# if(item2.colGroup){ }}","group","{{# } else { }}","{{d.index}}-{{i1}}-{{i2}}",'{{# if(item2.type !== "normal"){ }}'," laytable-cell-{{ item2.type }}","{{# } }}","{{# } }}",'" {{#if(item2.align){}}align="{{item2.align}}"{{#}}}>','{{# if(item2.type === "checkbox"){ }}','<input type="checkbox" name="layTableCheckbox" lay-skin="primary" lay-filter="layTableAllChoose" {{# if(item2[d.data.checkName]){ }}checked{{# }; }}>',"{{# } else { }}",'<span>{{item2.title||""}}</span>',"{{# if(isSort){ }}",'<span class="layui-table-sort layui-inline"><i class="layui-edge layui-table-sort-asc" title="升序"></i><i class="layui-edge layui-table-sort-desc" title="降序"></i></span>',"{{# } }}","{{# } }}","</div>","</th>",(P.fixed?"{{# }; }}":""),"{{# }); }}","</tr>","{{# }); }}","</thead>","</table>"].join("")},K=['<table cellspacing="0" cellpadding="0" border="0" class="layui-table" ','{{# if(d.data.skin){ }}lay-skin="{{d.data.skin}}"{{# } }} {{# if(d.data.size){ }}lay-size="{{d.data.size}}"{{# } }} {{# if(d.data.even){ }}lay-even{{# } }}>',"<tbody></tbody>","</table>"].join(""),s=['<div class="layui-form layui-border-box {{d.VIEW_CLASS}}" lay-filter="LAY-table-{{d.index}}" lay-id="{{ d.data.id }}" style="{{# if(d.data.width){ }}width:{{d.data.width}}px;{{# } }} {{# if(d.data.height){ }}height:{{d.data.height}}px;{{# } }}">',"{{# if(d.data.toolbar){ }}",'<div class="layui-table-tool">','<div class="layui-table-tool-temp"></div>','<div class="layui-table-tool-self"></div>',"</div>","{{# } }}",'<div class="layui-table-box">',"{{# var left, right; }}",'<div class="layui-table-header">',p(),"</div>",'<div class="layui-table-body layui-table-main">',K,"</div>","{{# if(left){ }}",'<div class="layui-table-fixed layui-table-fixed-l">','<div class="layui-table-header">',p({fixed:true}),"</div>",'<div class="layui-table-body">',K,"</div>","</div>","{{# }; }}","{{# if(right){ }}",'<div class="layui-table-fixed layui-table-fixed-r">','<div class="layui-table-header">',p({fixed:"right"}),'<div class="layui-table-mend"></div>',"</div>",'<div class="layui-table-body">',K,"</div>","</div>","{{# }; }}","</div>","{{# if(d.data.totalRow){ }}",'<div class="layui-table-total">','<table cellspacing="0" cellpadding="0" border="0" class="layui-table" ','{{# if(d.data.skin){ }}lay-skin="{{d.data.skin}}"{{# } }} {{# if(d.data.size){ }}lay-size="{{d.data.size}}"{{# } }} {{# if(d.data.even){ }}lay-even{{# } }}>','<tbody><tr><td><div class="layui-table-cell" style="visibility: hidden;">Total</div></td></tr></tbody>',"</table>","</div>","{{# } }}","{{# if(d.data.page){ }}",'<div class="layui-table-page">','<div id="layui-table-page{{d.index}}"></div>',"</div>","{{# } }}","<style>","{{# layui.each(d.data.cols, function(i1, item1){","layui.each(item1, function(i2, item2){ }}",".laytable-cell-{{d.index}}-{{i1}}-{{i2}}{ ","{{# if(item2.width){ }}","width: {{item2.width}}px;","{{# } }}"," }","{{# });","}); }}","</style>","</div>"].join(""),n=y(window),z=y(document),d=function(P){var Q=this;Q.index=++q.index;Q.config=y.extend({},Q.config,q.config,P);Q.render()};d.prototype.config={limit:10,loading:true,cellMinWidth:60,defaultToolbar:["filter","exports","print"],autoSort:true,text:{none:"无数据"}};d.prototype.render=function(){var T=this,R=T.config;R.elem=y(R.elem);R.where=R.where||{};R.id=R.id||R.elem.attr("id")||T.index;R.request=y.extend({pageName:"page",limitName:"limit"},R.request);R.response=y.extend({statusName:"code",statusCode:0,msgName:"msg",dataName:"data",countName:"count"},R.response);if(typeof R.page==="object"){R.limit=R.page.limit||R.limit;R.limits=R.page.limits||R.limits;T.page=R.page.curr=R.page.curr||1;delete R.page.elem;delete R.page.jump}if(!R.elem[0]){return T}if(R.height&&/^full-\d+$/.test(R.height)){T.fullHeightGap=R.height.split("-")[1];R.height=n.height()-T.fullHeightGap}if(R.maxHeight&&/^full-\d+$/.test(R.maxHeight)){T.fullHeightGap=R.maxHeight.split("-")[1];R.maxHeight=n.height()-T.fullHeightGap}T.setInit();var U=R.elem,P=U.next("."+B),Q=T.elem=y(I(s).render({VIEW_CLASS:B,data:R,index:T.index}));R.index=T.index;T.key=R.id||R.index;P[0]&&P.remove();U.after(Q);T.layTool=Q.find(b);T.layBox=Q.find(J);T.layHeader=Q.find(l);T.layMain=Q.find(E);T.layBody=Q.find(g);T.layFixed=Q.find(F);T.layFixLeft=Q.find(e);T.layFixRight=Q.find(O);T.layTotal=Q.find(c);T.layPage=Q.find(C);T.renderToolbar();T.fullSize();if(R.cols.length>1){var S=T.layFixed.find(l).find("th");S.height(T.layHeader.height()-1-parseFloat(S.css("padding-top"))-parseFloat(S.css("padding-bottom")))}T.pullData(T.page);T.events()};d.prototype.initOpts=function(S){var R=this,Q=R.config,P={checkbox:48,radio:48,space:15,numbers:40};if(S.checkbox){S.type="checkbox"}if(S.space){S.type="space"}if(!S.type){S.type="normal"}if(S.type!=="normal"){S.unresize=true;S.width=S.width||P[S.type]}};d.prototype.setInit=function(Q){var R=this,P=R.config;P.clientWidth=P.width||function(){var S=function(V){var U,T;V=V||P.elem.parent();U=V.width();try{T=V.css("display")==="none"}catch(W){}if(V[0]&&(!U||T)){return S(V.parent())}return U};return S()}();if(Q==="width"){return P.clientWidth}layui.each(P.cols,function(T,S){layui.each(S,function(V,U){if(!U){S.splice(V,1);return}U.key=T+"-"+V;U.hide=U.hide||false;if(U.colGroup||U.colspan>1){var W=0;layui.each(P.cols[T+1],function(Y,X){if(X.HAS_PARENT||(W>1&&W==U.colspan)){return}X.HAS_PARENT=true;X.parentKey=T+"-"+V;W=W+parseInt(X.colspan>1?X.colspan:1)});U.colGroup=true}R.initOpts(U)})})};d.prototype.renderToolbar=function(){var U=this,R=U.config;var Q=['<div class="layui-inline" lay-event="add"><i class="layui-icon layui-icon-add-1"></i></div>','<div class="layui-inline" lay-event="update"><i class="layui-icon layui-icon-edit"></i></div>','<div class="layui-inline" lay-event="delete"><i class="layui-icon layui-icon-delete"></i></div>'].join(""),V=U.layTool.find(".layui-table-tool-temp");if(R.toolbar==="default"){V.html(Q)}else{if(typeof R.toolbar==="string"){var S=y(R.toolbar).html()||"";S&&V.html(I(S).render(R))}}var T={filter:{title:"筛选列",layEvent:"LAYTABLE_COLS",icon:"layui-icon-cols"},exports:{title:"导出",layEvent:"LAYTABLE_EXPORT",icon:"layui-icon-export"},print:{title:"打印",layEvent:"LAYTABLE_PRINT",icon:"layui-icon-print"}},P=[];if(typeof R.defaultToolbar==="object"){layui.each(R.defaultToolbar,function(X,Y){var W=typeof Y==="string"?T[Y]:Y;if(W){P.push('<div class="layui-inline" title="'+W.title+'" lay-event="'+W.layEvent+'"><i class="layui-icon '+W.icon+'"></i></div>')}})}U.layTool.find(".layui-table-tool-self").html(P.join(""))};d.prototype.setParentCol=function(R,V){var S=this,X=S.config,Q=S.layHeader.find('th[data-key="'+X.index+"-"+V+'"]'),T=parseInt(Q.attr("colspan"))||0;if(Q[0]){var W=V.split("-"),U=X.cols[W[0]][W[1]];R?T--:T++;Q.attr("colspan",T);Q[T<1?"addClass":"removeClass"](i);U.colspan=T;U.hide=T<1;var P=Q.data("parentkey");P&&S.setParentCol(R,P)}};d.prototype.setColsPatch=function(){var Q=this,P=Q.config;layui.each(P.cols,function(S,R){layui.each(R,function(U,T){if(T.hide){Q.setParentCol(T.hide,T.parentKey)}})})};d.prototype.setColsWidth=function(){var V=this,aa=V.config,U=0,P=0,W=0,Y=0,Z=V.setInit("width");V.eachCols(function(ab,ac){ac.hide||U++});Z=Z-function(){return(aa.skin==="line"||aa.skin==="nob")?2:U+1}()-V.getScrollWidth(V.layMain[0])-1;var S=function(ab){layui.each(aa.cols,function(ad,ac){layui.each(ac,function(ah,ae){var ag=0,af=ae.minWidth||aa.cellMinWidth;if(!ae){ac.splice(ah,1);return}if(ae.colGroup||ae.hide){return}if(!ab){ag=ae.width||0;if(/\d+%$/.test(ag)){ag=Math.floor((parseFloat(ag)/100)*Z);ag<af&&(ag=af)}else{if(!ag){ae.width=ag=0;P++}}}else{if(W&&W<af){P--;ag=af}}if(ae.hide){ag=0}Y=Y+ag})});(Z>Y&&P)&&(W=(Z-Y)/P)};S();S(true);V.autoColNums=P;V.eachCols(function(ac,ab){var ad=ab.minWidth||aa.cellMinWidth;if(ab.colGroup||ab.hide){return}if(ab.width===0){V.getCssRule(aa.index+"-"+ab.key,function(ae){ae.style.width=Math.floor(W>=ad?W:ad)+"px"})}else{if(/\d+%$/.test(ab.width)){V.getCssRule(aa.index+"-"+ab.key,function(ae){ae.style.width=Math.floor((parseFloat(ab.width)/100)*Z)+"px"})}}});var T=V.layMain.width()-V.getScrollWidth(V.layMain[0])-V.layMain.children("table").outerWidth();if(V.autoColNums&&T>=-U&&T<=U){var Q=function(ab){var ac;ab=ab||V.layHeader.eq(0).find("thead th:last-child");ac=ab.data("field");if(!ac&&ab.prev()[0]){return Q(ab.prev())}return ab},R=Q(),X=R.data("key");V.getCssRule(X,function(ac){var ab=ac.style.width||R.outerWidth();ac.style.width=(parseFloat(ab)+T)+"px";if(V.layMain.height()-V.layMain.prop("clientHeight")>0){ac.style.width=(parseFloat(ac.style.width)-1)+"px"}})}};d.prototype.resize=function(){var P=this;P.fullSize();P.setColsWidth();P.scrollPatch()};d.prototype.reload=function(P){var Q=this;P=P||{};delete Q.haveInit;if(P.data&&P.data.constructor===Array){delete Q.config.data}Q.config=y.extend(true,{},Q.config,P);Q.render()};d.prototype.refresh=function(){var P=this;P.pullData(P.page)};d.prototype.reloadExt=function(P){var Q=this;if(Q.config.data&&Q.config.data.constructor===Array){delete Q.config.data}Q.config=y.extend({},Q.config,P);Q.page=1;Q.pullData(Q.page)};d.prototype.errorView=function(Q){var R=this,S=R.layMain.find("."+D),P=y('<div class="'+D+'">'+(Q||"Error")+"</div>");if(S[0]){R.layNone.remove();S.remove()}R.layFixed.addClass(i);R.layMain.find("tbody").html("");R.layMain.append(R.layNone=P);q.cache[R.key]=[]};d.prototype.page=1;d.prototype.pullData=function(X){var U=this,Y=U.config,R=Y.request,Q=Y.response,T=function(){if(typeof Y.initSort==="object"){U.sort(Y.initSort.field,Y.initSort.type)}};U.startTime=new Date().getTime();if(Y.url){var P={};P[R.pageName]=X;P[R.limitName]=Y.limit;var S=y.extend(P,Y.where);if(Y.contentType&&Y.contentType.indexOf("application/json")==0){S=JSON.stringify(S)}U.loading();y.ajax({type:Y.method||"get",url:Y.url,contentType:Y.contentType,data:S,cache:false,dataType:"json",headers:Y.headers||{},success:function(Z){if(typeof Y.parseData==="function"){Z=Y.parseData(Z)||Z}if(Z[Q.statusName]!=Q.statusCode){U.renderForm();U.errorView(Z[Q.msgName]||('返回的数据不符合规范，正确的成功状态码应为："'+Q.statusName+'": '+Q.statusCode))}else{U.renderData(Z,X,Z[Q.countName]),T();Y.time=(new Date().getTime()-U.startTime)+" ms"}U.setColsWidth();U.loading(!0);typeof Y.done==="function"&&Y.done(Z,X,Z[Q.countName])},error:function(aa,Z){U.errorView("数据接口请求异常："+Z);U.renderForm();U.setColsWidth();U.loading(!0)}})}else{if(Y.data&&Y.data.constructor===Array){var W={},V=X*Y.limit-Y.limit;W[Q.dataName]=Y.data.concat().splice(V,Y.limit);W[Q.countName]=Y.data.length;U.renderData(W,X,W[Q.countName]),T();U.setColsWidth();typeof Y.done==="function"&&Y.done(W,X,W[Q.countName])}}};d.prototype.eachCols=function(Q){var P=this;q.eachCols(null,Q,P.config.cols);return P};d.prototype.renderData=function(W,Y,T,R){var U=this,Z=U.config,Q=W[Z.response.dataName]||[],V=[],S=[],X=[],P=function(){var aa;if(!R&&U.sortKey){return U.sort(U.sortKey.field,U.sortKey.sort,true)}layui.each(Q,function(ag,ad){var af=[],ab=[],ae=[],ac=ag+Z.limit*(Y-1)+1;if(ad.length===0){return}if(!R){ad[q.config.indexName]=ag}U.eachCols(function(aj,ah){var al=ah.field||aj,ai=Z.index+"-"+ah.key,ak=ad[al];if(ak===undefined||ak===null){ak=""}if(ah.colGroup){return}var am=['<td data-field="'+al+'" data-key="'+ai+'" '+function(){var an=[];if(ah.edit){an.push('data-edit="'+ah.edit+'"')}if(ah.align){an.push('align="'+ah.align+'"')}if(ah.templet){an.push('data-content="'+ak+'"')}if(ah.toolbar){an.push('data-off="true"')}if(ah.event){an.push('lay-event="'+ah.event+'"')}if(ah.style){an.push('style="'+ah.style+'"')}if(ah.minWidth){an.push('data-minwidth="'+ah.minWidth+'"')}return an.join(" ")}()+' class="'+function(){var an=[];if(ah.hide){an.push(i)}if(!ah.field){an.push("layui-table-col-special")}return an.join(" ")}()+'">','<div class="layui-table-cell laytable-cell-'+function(){return ah.type==="normal"?ai:(ai+" laytable-cell-"+ah.type)}()+'">'+function(){var an=y.extend(true,{LAY_INDEX:ac},ad),ao=q.config.checkName;switch(ah.type){case"checkbox":return'<input type="checkbox" name="layTableCheckbox" lay-skin="primary" '+function(){if(ah[ao]){ad[ao]=ah[ao];return ah[ao]?"checked":""}return an[ao]?"checked":""}()+">";break;case"radio":if(an[ao]){aa=ag}return'<input type="radio" name="layTableRadio_'+Z.index+'" '+(an[ao]?"checked":"")+' lay-type="layTableRadio">';break;case"numbers":return ac;break}if(ah.toolbar){return I(y(ah.toolbar).html()||"").render(an)}return H(ah,ak,an)}(),"</div></td>"].join("");af.push(am);if(ah.fixed&&ah.fixed!=="right"){ab.push(am)}if(ah.fixed==="right"){ae.push(am)}});V.push('<tr data-index="'+ag+'">'+af.join("")+"</tr>");S.push('<tr data-index="'+ag+'">'+ab.join("")+"</tr>");X.push('<tr data-index="'+ag+'">'+ae.join("")+"</tr>")});U.layBody.scrollTop(0);U.layMain.find("."+D).remove();U.layMain.find("tbody").html(V.join(""));U.layFixLeft.find("tbody").html(S.join(""));U.layFixRight.find("tbody").html(X.join(""));U.renderForm();typeof aa==="number"&&U.setThisRowChecked(aa);U.syncCheckAll();U.haveInit?U.scrollPatch():setTimeout(function(){U.scrollPatch()},50);U.haveInit=true;h.close(U.tipsIndex);Z.HAS_SET_COLS_PATCH||U.setColsPatch();Z.HAS_SET_COLS_PATCH=true};q.cache[U.key]=Q;U.layPage[(T==0||(Q.length===0&&Y==1))?"addClass":"removeClass"](i);if(R){return P()}if(Q.length===0){U.renderForm();U.layFixed.remove();U.layMain.find("tbody").html("");U.layHeader.css("overflow","auto");U.layMain.find("."+D).remove();return U.layMain.append('<div class="'+D+'">'+Z.text.none+"</div>")}else{U.layHeader.css("overflow","hidden");U.layMain.find("."+D).remove()}P();U.renderTotal(Q);if(Z.page){Z.page=y.extend({elem:"layui-table-page"+Z.index,count:T,limit:Z.limit,limits:Z.limits||[10,20,30,40,50,60,70,80,90],groups:3,layout:["prev","page","next","skip","count","limit"],prev:'<i class="layui-icon">&#xe603;</i>',next:'<i class="layui-icon">&#xe602;</i>',jump:function(aa,ab){if(!ab){U.page=aa.curr;U.config.limit=aa.limit;U.pullData(aa.curr)}}},Z.page);Z.page.curr=Y;Z.page.count=T;m.render(Z.page)}};d.prototype.renderTotal=function(T){var S=this,P=S.config,R={};if(!P.totalRow){return}layui.each(T,function(V,U){if(U.length===0){return}S.eachCols(function(X,W){var Z=W.field||X,Y=U[Z];if(W.totalRow){R[Z]=(R[Z]||0)+(parseFloat(Y)||0)}})});S.dataTotal={};var Q=[];S.eachCols(function(V,U){var X=U.field||V;var W=function(){var ab=U.totalRowText||"",aa=parseFloat(R[X]).toFixed(2),Z={};Z[X]=aa;aa=H(U,aa,Z);return U.totalRow?(aa||ab):ab}(),Y=['<td data-field="'+X+'" data-key="'+P.index+"-"+U.key+'" '+function(){var Z=[];if(U.align){Z.push('align="'+U.align+'"')}if(U.style){Z.push('style="'+U.style+'"')}if(U.minWidth){Z.push('data-minwidth="'+U.minWidth+'"')}return Z.join(" ")}()+' class="'+function(){var Z=[];if(U.hide){Z.push(i)}if(!U.field){Z.push("layui-table-col-special")}return Z.join(" ")}()+'">','<div class="layui-table-cell laytable-cell-'+function(){var Z=(P.index+"-"+U.key);return U.type==="normal"?Z:(Z+" laytable-cell-"+U.type)}()+'">'+W,"</div></td>"].join("");U.field&&(S.dataTotal[X]=W);Q.push(Y)});S.layTotal.find("tbody").html("<tr>"+Q.join("")+"</tr>")};d.prototype.getColElem=function(R,Q){var S=this,P=S.config;return R.eq(0).find(".laytable-cell-"+(P.index+"-"+Q)+":eq(0)")};d.prototype.renderForm=function(P){A.render(P,"LAY-table-"+this.index)};d.prototype.setThisRowChecked=function(Q){var R=this,P=R.config,T="layui-table-click",S=R.layBody.find('tr[data-index="'+Q+'"]');S.addClass(T).siblings("tr").removeClass(T)};d.prototype.sort=function(Q,Y,ab,R){var U=this,Z,X={},ac=U.config,P=ac.elem.attr("lay-filter"),S=q.cache[U.key],T;if(typeof Q==="string"){U.layHeader.find("th").each(function(ae,af){var ag=y(this),ad=ag.data("field");if(ad===Q){Q=ag;Z=ad;return false}})}try{var Z=Z||Q.data("field"),aa=Q.data("key");if(U.sortKey&&!ab){if(Z===U.sortKey.field&&Y===U.sortKey.sort){return}}var W=U.layHeader.find("th .laytable-cell-"+aa).find(w);U.layHeader.find("th").find(w).removeAttr("lay-sort");W.attr("lay-sort",Y||null);U.layFixed.find("th")}catch(V){return r.error("Table modules: Did not match to field")}U.sortKey={field:Z,sort:Y};if(ac.autoSort){if(Y==="asc"){T=layui.sort(S,Z)}else{if(Y==="desc"){T=layui.sort(S,Z,true)}else{T=layui.sort(S,q.config.indexName);delete U.sortKey}}}X[ac.response.dataName]=T||S;U.renderData(X,U.page,U.count,true);if(R){layui.event.call(Q,N,"sort("+P+")",{field:Z,type:Y})}};d.prototype.loading=function(Q){var R=this,P=R.config;if(P.loading){if(Q){R.loadindex&&h.close(R.loadindex);delete R.loadindex}else{R.loadindex=h.load(1)}}};d.prototype.setCheckData=function(Q,T){var S=this,P=S.config,R=q.cache[S.key];if(!R[Q]){return}if(R[Q].constructor===Array){return}R[Q][P.checkName]=T};d.prototype.syncCheckAll=function(){var S=this,P=S.config,R=S.layHeader.find('input[name="layTableCheckbox"]'),Q=function(T){S.eachCols(function(U,V){if(V.type==="checkbox"){V[P.checkName]=T}});return T};if(!R[0]){return}if(q.checkStatus(S.key).isAll){if(!R[0].checked){R.prop("checked",true);S.renderForm("checkbox")}Q(true)}else{if(R[0].checked){R.prop("checked",false);S.renderForm("checkbox")}Q(false)}};d.prototype.getCssRule=function(Q,U){var S=this,R=S.elem.find("style")[0],P=R.sheet||R.styleSheet||{},T=P.cssRules||P.rules;layui.each(T,function(V,W){if(W.selectorText===(".laytable-cell-"+Q)){return U(W),true}})};d.prototype.fullSize=function(){var R=this,Q=R.config,P=Q.height||Q.maxHeight,S;if(R.fullHeightGap){P=n.height()-R.fullHeightGap;if(P<135){P=135}if(Q.height){R.elem.css("height",P)}else{if(Q.maxHeight){R.elem.css("max-height",P)}}}if(!P){return}S=parseFloat(P)-(R.layHeader.outerHeight()||38);if(Q.toolbar){S=S-(R.layTool.outerHeight()||50)}if(Q.totalRow){S=S-(R.layTotal.outerHeight()||40)}if(Q.page){S=S-(R.layPage.outerHeight()||41)-2}if(Q.height){R.layMain.css("height",S)}else{if(Q.maxHeight){R.layMain.css("max-height",S)}}};d.prototype.getScrollWidth=function(Q){var P=0;if(Q){P=Q.offsetWidth-Q.clientWidth}else{Q=document.createElement("div");Q.style.width="100px";Q.style.height="100px";Q.style.overflowY="scroll";document.body.appendChild(Q);P=Q.offsetWidth-Q.clientWidth;document.body.removeChild(Q)}return P};d.prototype.scrollPatch=function(){var T=this,R=T.layMain.children("table"),W=T.layMain.width()-T.layMain.prop("clientWidth"),X=T.layMain.height()-T.layMain.prop("clientHeight"),U=T.getScrollWidth(T.layMain[0]),P=R.outerWidth()-T.layMain.width(),S=function(Y){if(W&&X){Y=Y.eq(0);if(!Y.find(".layui-table-patch")[0]){var Z=y('<th class="layui-table-patch"><div class="layui-table-cell"></div></th>');Z.find("div").css({width:W});Y.find("tr").append(Z)}}else{Y.find(".layui-table-patch").remove()}};S(T.layHeader);S(T.layTotal);var V=T.layMain.height(),Q=V-X;T.layFixed.find(g).css("height",R.height()>=Q?Q:"auto");T.layFixRight[P>0?"removeClass":"addClass"](i);T.layFixRight.css("right",W-1)};d.prototype.events=function(){var W=this,ac=W.config,S=y("body"),T={},Q=W.layHeader.find("th"),Y,aa=".layui-table-cell",R=ac.elem.attr("lay-filter");W.layTool.on("click","*[lay-event]",function(ai){var ah=y(this),af=ah.attr("lay-event"),ad=function(al){var am=y(al.list),ak=y('<ul class="layui-table-tool-panel"></ul>');ak.html(am);if(ac.height){ak.css("max-height",ac.height-(W.layTool.outerHeight()||50))}else{if(ac.maxHeight){ak.css("max-height",ac.maxHeight-(W.layTool.outerHeight()||50))}}ah.find(".layui-table-tool-panel")[0]||ah.append(ak);W.renderForm();ak.on("click",function(an){layui.stope(an)});al.done&&al.done(ak,am)};layui.stope(ai);z.trigger("table.tool.panel.remove");h.close(W.tipsIndex);switch(af){case"LAYTABLE_COLS":ad({list:function(){var ak=[];W.eachCols(function(al,am){if(am.field&&am.type=="normal"){ak.push('<li><input type="checkbox" name="'+am.field+'" data-key="'+am.key+'" data-parentkey="'+(am.parentKey||"")+'" lay-skin="primary" '+(am.hide?"":"checked")+' title="'+(am.title||am.field)+'" lay-filter="LAY_TABLE_TOOL_COLS"></li>')}});return ak.join("")}(),done:function(){A.on("checkbox(LAY_TABLE_TOOL_COLS)",function(ao){var an=y(ao.elem),am=this.checked,al=an.data("key"),ak=an.data("parentkey");layui.each(ac.cols,function(aq,ap){layui.each(ap,function(au,ar){if(aq+"-"+au===al){var at=ar.hide;ar.hide=!am;W.elem.find('*[data-key="'+ac.index+"-"+al+'"]')[am?"removeClass":"addClass"](i);if(at!=ar.hide){W.setParentCol(!am,ak)}W.resize()}})})})}});break;case"LAYTABLE_EXPORT":if(M.ie){h.tips("导出功能不支持 IE，请用 Chrome 等高级浏览器导出",this,{tips:3})}else{ad({list:function(){return['<li data-type="csv">导出到 Csv 文件</li>','<li data-type="xls">导出到 Excel 文件</li>'].join("")}(),done:function(ak,al){al.on("click",function(){var am=y(this).data("type");q.exportFile.call(W,ac.id,null,am)})}})}break;case"LAYTABLE_PRINT":var aj=window.open("打印窗口","_blank"),ag=["<style>","body{font-size: 12px; color: #666;}","table{width: 100%; border-collapse: collapse; border-spacing: 0;}","th,td{line-height: 20px; padding: 9px 15px; border: 1px solid #ccc; text-align: left; font-size: 12px; color: #666;}","a{color: #666; text-decoration:none;}","*.layui-hide{display: none}","</style>"].join(""),ae=y(W.layHeader.html());ae.append(W.layMain.find("table").html());ae.append(W.layTotal.find("table").html());ae.find("th.layui-table-patch").remove();ae.find(".layui-table-col-special").remove();aj.document.write(ag+ae.prop("outerHTML"));aj.document.close();aj.print();aj.close();break}layui.event.call(this,N,"toolbar("+R+")",y.extend({event:af,config:ac},{}))});Q.on("mousemove",function(ag){var af=y(this),ad=af.offset().left,ae=ag.clientX-ad;if(af.data("unresize")||T.resizeStart){return}T.allowResize=af.width()-ae<=10;S.css("cursor",(T.allowResize?"col-resize":""))}).on("mouseleave",function(){var ad=y(this);if(T.resizeStart){return}S.css("cursor","")}).on("mousedown",function(af){var ae=y(this);if(T.allowResize){var ad=ae.data("key");af.preventDefault();T.resizeStart=true;T.offset=[af.clientX,af.clientY];W.getCssRule(ad,function(ah){var ag=ah.style.width||ae.outerWidth();T.rule=ah;T.ruleWidth=parseFloat(ag);T.minWidth=ae.data("minwidth")||ac.cellMinWidth})}});z.on("mousemove",function(ae){if(T.resizeStart){ae.preventDefault();if(T.rule){var ad=T.ruleWidth+ae.clientX-T.offset[0];if(ad<T.minWidth){ad=T.minWidth}T.rule.style.width=ad+"px";h.close(W.tipsIndex)}Y=1}}).on("mouseup",function(ad){if(T.resizeStart){T={};S.css("cursor","");W.scrollPatch()}if(Y===2){Y=null}});Q.on("click",function(ah){var af=y(this),ag=af.find(w),ad=ag.attr("lay-sort"),ae;if(!ag[0]||Y===1){return Y=2}if(ad==="asc"){ae="desc"}else{if(ad==="desc"){ae=null}else{ae="asc"}}W.sort(af,ae,null,true)}).find(w+" .layui-edge ").on("click",function(ag){var ae=y(this),ad=ae.index(),af=ae.parents("th").eq(0).data("field");layui.stope(ag);if(ad===0){W.sort(af,"asc",null,true)}else{W.sort(af,"desc",null,true)}});var Z=function(ae){var ah=y(this),ad=ah.parents("tr").eq(0).data("index"),ag=W.layBody.find('tr[data-index="'+ad+'"]'),af=q.cache[W.key]||[];af=af[ad]||{};return y.extend({tr:ag,data:q.clearCacheKey(af),del:function(){q.cache[W.key][ad]=[];ag.remove();W.scrollPatch()},update:function(ai){ai=ai||{};layui.each(ai,function(ak,al){if(ak in af){var aj,am=ag.children('td[data-field="'+ak+'"]');af[ak]=al;W.eachCols(function(ao,an){if(an.field==ak&&an.templet){aj=an.templet}});am.children(aa).html(H({templet:aj},al,af));am.data("content",al)}})}},ae)};W.elem.on("click",'input[name="layTableCheckbox"]+',function(){var ah=y(this).prev(),ag=W.layBody.find('input[name="layTableCheckbox"]'),ae=ah.parents("tr").eq(0).data("index"),af=ah[0].checked,ad=ah.attr("lay-filter")==="layTableAllChoose";if(ad){ag.each(function(ai,aj){aj.checked=af;W.setCheckData(ai,af)});W.syncCheckAll();W.renderForm("checkbox")}else{W.setCheckData(ae,af);W.syncCheckAll()}layui.event.call(ah[0],N,"checkbox("+R+")",Z.call(ah[0],{checked:af,type:ad?"all":"one"}))});W.elem.on("click",'input[lay-type="layTableRadio"]+',function(){var ae=y(this).prev(),ag=ae[0].checked,af=q.cache[W.key],ad=ae.parents("tr").eq(0).data("index");layui.each(af,function(ah,ai){if(ad===ah){ai.LAY_CHECKED=true}else{delete ai.LAY_CHECKED}});W.setThisRowChecked(ad);layui.event.call(this,N,"radio("+R+")",Z.call(this,{checked:ag}))});W.layBody.on("mouseenter","tr",function(){var ae=y(this),ad=ae.index();if(ae.data("off")){return}W.layBody.find("tr:eq("+ad+")").addClass(G)}).on("mouseleave","tr",function(){var ae=y(this),ad=ae.index();if(ae.data("off")){return}W.layBody.find("tr:eq("+ad+")").removeClass(G)}).on("click","tr",function(){V.call(this,"row")}).on("dblclick","tr",function(){V.call(this,"rowDouble")});var V=function(ad){var ae=y(this);if(ae.data("off")){return}layui.event.call(this,N,ad+"("+R+")",Z.call(ae.children("td")[0]))};W.layBody.on("change","."+a,function(){var ag=y(this),af=this.value,ah=ag.parent().data("field"),ad=ag.parents("tr").eq(0).data("index"),ae=q.cache[W.key][ad];ae[ah]=af;layui.event.call(this,N,"edit("+R+")",Z.call(this,{value:af,field:ah}))}).on("blur","."+a,function(){var ad,ah=y(this),af=this,ai=ah.parent().data("field"),ae=ah.parents("tr").eq(0).data("index"),ag=q.cache[W.key][ae];W.eachCols(function(aj,ak){if(ak.field==ai&&ak.templet){ad=ak.templet}});ah.siblings(aa).html(function(aj){return H({templet:ad},aj,ag)}(af.value));ah.parent().data("content",af.value);ah.remove()});W.layBody.on("click","td",function(ai){var ag=y(this),ah=ag.data("field"),ae=ag.data("edit"),af=ag.children(aa);if(ag.data("off")){return}if(ae){var ad=y('<input class="layui-input '+a+'">');ad[0].value=ag.data("content")||af.text();ag.find("."+a)[0]||ag.append(ad);ad.focus();layui.stope(ai);return}}).on("mouseenter","td",function(){P.call(this)}).on("mouseleave","td",function(){P.call(this,"hide")});var ab="layui-table-grid",U="layui-table-grid-down",X="layui-table-grid-panel",P=function(ae){var af=y(this),ad=af.children(aa);if(af.data("off")){return}if(ae){af.find(".layui-table-grid-down").remove()}else{if(ad.prop("scrollWidth")>ad.outerWidth()){if(ad.find("."+U)[0]){return}af.append('<div class="'+U+'"><i class="layui-icon layui-icon-down"></i></div>')}}};W.layBody.on("click","."+U,function(af){var ae=y(this),ag=ae.parent(),ad=ag.children(aa);W.tipsIndex=h.tips(['<div class="layui-table-tips-main" style="margin-top: -'+(ad.height()+16)+"px;"+function(){if(ac.size==="sm"){return"padding: 4px 15px; font-size: 12px;"}if(ac.size==="lg"){return"padding: 14px 15px;"}return""}()+'">',ad.html(),"</div>",'<i class="layui-icon layui-table-tips-c layui-icon-close"></i>'].join(""),ad[0],{tips:[3,""],time:-1,anim:-1,maxWidth:(M.ios||M.android)?300:W.elem.width()/2,isOutAnim:false,skin:"layui-table-tips",success:function(ah,ai){ah.find(".layui-table-tips-c").on("click",function(){h.close(ai)})}});layui.stope(af)});W.layBody.on("click","*[lay-event]",function(){var ae=y(this),ad=ae.parents("tr").eq(0).data("index");layui.event.call(this,N,"tool("+R+")",Z.call(this,{event:ae.attr("lay-event")}));W.setThisRowChecked(ad)});W.layMain.on("scroll",function(){var ad=y(this),af=ad.scrollLeft(),ae=ad.scrollTop();W.layHeader.scrollLeft(af);W.layTotal.scrollLeft(af);W.layFixed.find(g).scrollTop(ae);h.close(W.tipsIndex)});n.on("resize",function(){W.resize()})};(function(){z.on("click",function(){z.trigger("table.remove.tool.panel")});z.on("table.remove.tool.panel",function(){y(".layui-table-tool-panel").remove()})})();q.init=function(S,R){R=R||{};var T=this,Q=S?y('table[lay-filter="'+S+'"]'):y(j+"[lay-data]"),P="Table element property lay-data configuration item has a syntax error: ";Q.each(function(){var W=y(this),V=W.attr("lay-data");try{V=new Function("return "+V)()}catch(Y){r.error(P+V)}var X=[],U=y.extend({elem:this,cols:[],data:[],skin:W.attr("lay-skin"),size:W.attr("lay-size"),even:typeof W.attr("lay-even")==="string"},q.config,R,V);S&&W.hide();W.find("thead>tr").each(function(Z){U.cols[Z]=[];y(this).children().each(function(ab){var ac=y(this),aa=ac.attr("lay-data");try{aa=new Function("return "+aa)()}catch(ad){return r.error(P+aa)}var ae=y.extend({title:ac.text(),colspan:ac.attr("colspan")||0,rowspan:ac.attr("rowspan")||0},aa);if(ae.colspan<2){X.push(ae)}U.cols[Z].push(ae)})});W.find("tbody>tr").each(function(Z){var aa=y(this),ab={};aa.children("td").each(function(ad,ac){var af=y(this),ae=af.data("field");if(ae){return ab[ae]=af.html()}});layui.each(X,function(ad,ac){var ae=aa.children("td").eq(ad);ab[ac.field]=ae.html()});U.data[Z]=ab});q.render(U)});return T};o.that={};o.config={};q.eachCols=function(V,U,T){var R=o.config[V]||{},Q=[],P=0;T=y.extend(true,[],T||R.cols);layui.each(T,function(X,W){layui.each(W,function(Z,Y){if(Y.colGroup){var aa=0;P++;Y.CHILD_COLS=[];layui.each(T[X+1],function(ac,ab){if(ab.PARENT_COL_INDEX||(aa>1&&aa==Y.colspan)){return}ab.PARENT_COL_INDEX=P;Y.CHILD_COLS.push(ab);aa=aa+parseInt(ab.colspan>1?ab.colspan:1)})}if(Y.PARENT_COL_INDEX){return}Q.push(Y)})});var S=function(W){layui.each(W||Q,function(X,Y){if(Y.CHILD_COLS){return S(Y.CHILD_COLS)}typeof U==="function"&&U(X,Y)})};S()};q.checkStatus=function(T){var S=0,Q=0,P=[],R=q.cache[T]||[];layui.each(R,function(U,V){if(V.constructor===Array){Q++;return}if(V[q.config.checkName]){S++;P.push(q.clearCacheKey(V))}});return{data:P,isAll:R.length?(S===(R.length-Q)):false}};q.exportFile=function(V,T,R){var S=this;T=T||q.clearCacheKey(q.cache[V]);R=R||"csv";var P=o.config[V]||{},U=({csv:"text/csv",xls:"application/vnd.ms-excel"})[R],Q=document.createElement("a");if(M.ie){return r.error("IE_NOT_SUPPORT_EXPORTS")}Q.href="data:"+U+";charset=utf-8,\ufeff"+encodeURIComponent(function(){var Y=[],X=[],W=[];layui.each(T,function(aa,Z){var ab=[];if(typeof V==="object"){layui.each(V,function(ac,ad){aa==0&&Y.push(ad||"")});layui.each(q.clearCacheKey(Z),function(ad,ac){ab.push('"'+(ac||"")+'"')})}else{q.eachCols(V,function(ad,ac){if(ac.field&&ac.type=="normal"&&!ac.hide){var ae=Z[ac.field];if(ae===undefined||ae===null){ae=""}aa==0&&Y.push(ac.title||"");ab.push('"'+H(ac,ae,Z,"text")+'"')}})}X.push(ab.join(","))});layui.each(S.dataTotal,function(Z,aa){W.push(aa)});return Y.join(",")+"\r\n"+X.join("\r\n")+"\r\n"+W.join(",")}());Q.download=(P.title||"table_"+(P.index||""))+"."+R;document.body.appendChild(Q);Q.click();document.body.removeChild(Q)};q.resize=function(Q){if(Q){var P=t(Q);if(!P){return}o.that[Q].resize()}else{layui.each(o.that,function(){this.resize()})}};q.reload=function(S,Q){var P=t(S);if(!P){return}var R=o.that[S];R.reload(Q);return o.call(R)};q.refresh=function(Q){if(Q){var P=t(Q);if(!P){return}o.that[Q].refresh()}};q.reloadExt=function(R,Q){if(R){var P=t(R);if(!P){return}o.that[R].reloadExt(Q)}};q.render=function(P){var Q=new d(P);return o.call(Q)};q.clearCacheKey=function(P){P=y.extend({},P);delete P[q.config.checkName];delete P[q.config.indexName];return P};q.init();L(N,q)});
